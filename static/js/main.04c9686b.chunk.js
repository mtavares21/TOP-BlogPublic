(this["webpackJsonpblog-public"]=this["webpackJsonpblog-public"]||[]).push([[0],{23:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(18),a=n.n(s),u=(n(9),n(2)),l=(n(23),n(3)),i=n.n(l),o=n(5),f=n(25);function d(){return(d=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/users/signup",{method:"POST",headers:{"Content-Type":"application/json",Credentials:"include"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.post("https://gentle-refuge-60877.herokuapp.com/v1/users/login",{username:t.username,password:t.password});case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function m(){return(m=Object(o.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/allPosts",{method:"GET",headers:{"Content-Type":"application/json",Accept:"*/*",Credentials:"include"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/comments/?postid=".concat(encodeURIComponent(t)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"*/*",Credentials:"include",Authorization:"Bearer "+n}});case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(o.a)(i.a.mark((function e(t,n,r){var c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/comments/?postid=".concat(t),{method:"POST",headers:{"Content-Type":"application/json",Accept:"*/*",Credentials:"true",Authorization:"Bearer "+n},body:JSON.stringify({text:r})}).catch((function(e){return console.log(e)}));case 2:return c=e.sent,e.next=5,c.json().catch((function(e){return console.log(e)}));case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(o.a)(i.a.mark((function e(t,n,r){var c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/comments/".concat(t,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer "+n},body:JSON.stringify({text:r})}).catch((function(e){return console.log(e)}));case 2:return c=e.sent,e.next=5,c.json().catch((function(e){return console.log(e)}));case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(o.a)(i.a.mark((function e(t,n){var r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gentle-refuge-60877.herokuapp.com/v1/comments/".concat(n),{method:"DELETE",headers:{"Content-Type":"x-www-form-urlencoded",Accept:"*/*",Authorization:"Bearer "+t}});case 2:return r=e.sent,e.next=5,r.json();case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=n(0);function O(e){var t=e.id,n=e.text,c=e.author,s=e.date,a=Object(r.useState)(!1),l=Object(u.a)(a,2),i=l[0],o=l[1],f=Object(r.useState)(null),d=Object(u.a)(f,2),j=d[0],m=d[1],x=Object(r.useState)(n),p=Object(u.a)(x,2),O=p[0],v=p[1],y=Object(r.useState)(!1),g=Object(u.a)(y,2),N=g[0],k=g[1],C=Object(r.useContext)(S);return Object(w.jsx)("div",{className:"".concat(N?"hidden":"flex"," container w-full p-5 pr-10 mt-5 max-h-42 mb-3 grid items-center justify-center bg-red-400 rounded-full text-white"),children:Object(w.jsxs)("form",{className:"md:w-full",children:[Object(w.jsxs)("div",{className:"my-2 w-full max-h-40 flex flex-wrap items-start justify-center ",children:[Object(w.jsxs)("h1",{className:"w-full mb-2 text-white font-sans font-medium overflow-scroll text-md",children:[c.username,":"]}),i?Object(w.jsx)("textarea",{defaultValue:n,className:"w-full max-h-20 h-full overflow-scroll font-serif text-black text-justify"}):Object(w.jsx)("div",{className:"w-full max-h-42 flex flex-wrap  items-start justify-center ",children:Object(w.jsx)("p",{className:"flex md:w-96 sm:96 ml-4 max-h-16 h-full overflow-scroll font-serif text-justify",children:O})})]}),Object(w.jsxs)("div",{className:"flex md:flex-nowrap flex-wrap mt-2 w-full md:justify-between justify-center",children:[i?Object(w.jsx)("div",{className:"w-20 ml-4 max-h-16 h-full",children:" "}):Object(w.jsx)("p",{className:"flex justify-start mt-1 md:w-full  w-full font-serif text-sm text-center",children:s}),C.user_id===c._id?Object(w.jsxs)("div",{className:"flex flex-nowrap w-1/3 justify-center md:justify-end",children:[Object(w.jsx)("button",{onClick:i?function(e){var n=e.target.form[0].value;(function(e,t,n){return b.apply(this,arguments)})(t,C.token,n).then((function(e){v((function(e){return n}))})).catch((function(e){return m((function(e){return j}))})).finally((function(){return o((function(e){return!1}))}))}:function(){return o((function(e){return!0}))},type:"button",className:"p-1 h-7 mb-1 mx-1 flex rounded-full bg-white px-5 text-sm text-red-400",children:i?"Save":"Edit"}),Object(w.jsx)("button",{onClick:function(){(function(e,t){return h.apply(this,arguments)})(C.token,t).then(k(!0)).catch((function(e){return m((function(t){return e}))})).finally((function(){return o(!1)}))},type:"button",className:"p-1 h-7 flex rounded-full bg-white px-3 text-sm text-red-400",children:"Delete"})]}):null]})]})},t)}function v(e){var t=e.postid,n=e.setNewComment,c=Object(r.useState)(!1),s=Object(u.a)(c,2),a=(s[0],s[1]),l=Object(r.useContext)(S);return Object(w.jsx)("div",{className:"container w-full sm:py-3 sm:px-9 px-5 py-5 max-h-52 mb-3 md:w-5/6 flex flex-wrap items-center sm:justify-center bg-red-400 rounded-full text-white",children:Object(w.jsx)("form",{className:"flex w-full max-h-52 justify-center flex-wrap",children:Object(w.jsxs)("div",{className:"w-full max-h-52 flex flex-wrap items-center justify-center",children:[Object(w.jsx)("textarea",{className:"w-96 sm:mt-5 max-h-20 h-full overflow-scroll font-serif text-black text-justify"}),Object(w.jsxs)("div",{className:"flex sm:flex-wrap md:justify-end justify-center items-center sm:h-1/4 w-full mx-5",children:[Object(w.jsx)("button",{type:"button",onClick:function(e){var r=e.target.form[0].value;(function(e,t,n){return p.apply(this,arguments)})(t,l.token,r).then((function(e){n((function(e){return!1}))})).catch((function(e){a((function(t){return e}))}))},className:"p-1 my-2 flex rounded-full bg-white px-2 text-sm text-red-400",children:"Save"}),Object(w.jsx)("button",{type:"button",onClick:function(){n((function(e){return!1}))},className:"p-1 my-2 ml-2 flex rounded-full bg-white px-2 text-sm text-red-400",children:"Cancel"})]})]})})})}function y(e){var t=e.type,n=e.label,r=e.onClick;return Object(w.jsx)("button",{type:t,onClick:r,className:"p-1 mt-3 mx-full flex rounded-full bg-red-400 px-2 text-sm text-white",children:n})}function g(e){var t=e.postId,n=e.title,c=e.text,s=e.date,a=e.isPublished,l=e.html,i=e.preview,o=Object(r.useState)([]),f=Object(u.a)(o,2),d=f[0],j=f[1],m=Object(r.useState)(!1),p=Object(u.a)(m,2),b=p[0],h=p[1],g=Object(r.useState)(!0),N=Object(u.a)(g,2),k=N[0],C=N[1],T=Object(r.useState)(!1),_=Object(u.a)(T,2),A=_[0],E=_[1],P=Object(r.useState)(!1),D=Object(u.a)(P,2),z=D[0],B=D[1],I=Object(r.useContext)(S);Object(r.useEffect)((function(){return z&&I&&function(e,t){return x.apply(this,arguments)}(t,I.token).then((function(e){j((function(t){return e}))})).catch((function(e){E((function(e){return!0}))})).finally((function(){C((function(e){return!1}))})),function(){return E((function(e){return!1}))}}),[t,z,I]);return a?Object(w.jsxs)("div",{className:"dark:bg-gray-700 container mt-10 md:w-2/3 flex flex-wrap items-center justify-center bg-white",children:[Object(w.jsxs)("div",{className:"container mt-10 flex flex-wrap justify-center items-center",children:[Object(w.jsx)("div",{className:"flex flex-row no-wrap items-center w-full",children:Object(w.jsx)("h1",{className:"w-full my-10 text-center text-red-400 font-sans font-bold text-4xl",children:n})}),Object(w.jsx)("p",{className:"dark:text-gray-200 w-full font-serif text-justify min-h-70",children:l?Object(w.jsx)("div",{dangerouslySetInnerHTML:{__html:l}}):c}),Object(w.jsx)("p",{className:"w-full font-serif underline-red-500",children:Object(w.jsx)("mark",{className:"bg-red-400 px-2 text-sm text-white",children:s})})]}),Object(w.jsxs)("div",{className:"flex flex-wrap w-full",children:[I&&b?Object(w.jsx)(v,{postid:t,setNewComment:h}):I?Object(w.jsx)(y,{onClick:i?function(){}:function(){return h((function(e){return!e}))},label:"New Comment"}):null,Object(w.jsxs)("div",{className:"w-full",children:[I?Object(w.jsx)(y,{onClick:i?function(){}:function(){return B((function(e){return!e}))},label:z?"Hide comments":"See comments"}):null,z&&I?k?Object(w.jsx)("div",{className:"loader"}):A?"Failed to load comments.":d.length?d.map((function(e){var t=new Date(e.updatedAt);return Object(w.jsx)("div",{className:"flex flex-wrap w-full justify-start",children:Object(w.jsx)(O,{id:e._id,author:e.author,text:e.text,date:t.toDateString()})},e._id)})):"No comments yet.":null]})]})]}):null}function N(e){var t=e.setShow;return Object(w.jsx)("div",{className:"absolute sm:right-12 right-4  top-0",children:Object(w.jsx)("div",{onClick:function(){return t((function(e){return!e}))},className:"flex flex-wrap justify-center w-full",children:Object(w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"sm:h-10 sm:w-10 h-7 w-7 absolute right-1 top-8",viewBox:"0 0 20 20",fill:"currentColor",children:Object(w.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})})})}function k(e){var t=e.setUser,n=Object(r.useState)(null),c=Object(u.a)(n,2),s=c[0],a=c[1],l=Object(r.useState)(null),i=Object(u.a)(l,2),o=i[0],f=i[1],m=Object(r.useContext)(S),x=function(e){e.preventDefault(),function(e){return j.apply(this,arguments)}({username:e.target.form[0].value,password:e.target.form[1].value}).then((function(n,r){r?f((function(e){return"Log-in failed."})):t({user_id:n.user_id,username:n.username,token:n.token,password:e.target.form[1].value})}))},p=function(e){e.preventDefault(),function(e){return d.apply(this,arguments)}({username:e.target.form[0].value,password:e.target.form[1].value}).then((function(e){e.errors?(f((function(t){return e.errors[0]})),console.log(s)):f((function(t){return e}))}))};return Object(r.useEffect)((function(){return a((function(e){return o})),function(){return a((function(e){return null}))}}),[o]),Object(w.jsx)("div",{className:"absolute top-24 right-0 h-30 md:w-1/3 sm:w-40 w-full bg-gray-800 px-5 pb-5 z-10 font-sans text-base text-justify",children:m?Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"text-red-400 font-bold text-center mt-4",children:m.username}),Object(w.jsx)("button",{type:"button",onClick:function(e){t((function(e){return null}))},className:"text-red-400 w-full mb-2",children:"Log-out"})]}):Object(w.jsxs)("form",{className:"container flex flex-wrap w-full justify-center items-between",children:[Object(w.jsx)("input",{name:"username",type:"email",placeholder:"username/mail",className:"w-full my-3"}),Object(w.jsx)("input",{name:"password",type:"password",placeholder:"password",className:"w-full mb-3"}),Object(w.jsx)("p",{children:s}),Object(w.jsx)("button",{type:"button",onClick:function(e){return x(e)},className:"text-red-400 w-full mb-2",children:"Log-in"}),Object(w.jsx)("button",{type:"button",onClick:function(e){return p(e)},className:"text-red-400 w-full",children:"Sign-up"})]})})}var S=c.a.createContext(null);var C=function(e){return!(new DOMParser).parseFromString("<div>"+function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}(e)+"</div>","text/xml").querySelector("parsererror")};function T(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(!0),a=Object(u.a)(s,2),l=a[0],i=a[1],o=Object(r.useState)(!1),f=Object(u.a)(o,2),d=f[0],j=f[1],x=Object(r.useState)(!1),p=Object(u.a)(x,2),b=p[0],h=p[1],O=Object(r.useState)(null),v=Object(u.a)(O,2),y=v[0],T=v[1],_=Object(r.useState)(window.matchMedia("(prefers-color-scheme: dark)").matches),A=Object(u.a)(_,2),E=A[0],P=A[1];Object(r.useEffect)((function(){(function(){return m.apply(this,arguments)})().then((function(e){c((function(t){return e}))})).catch((function(e){j((function(t){return e}))})).finally((function(){i((function(e){return!1}))}))}),[]);return Object(w.jsx)(S.Provider,{value:y,children:Object(w.jsxs)("div",{className:"".concat(E?"dark":null," w-screen min-h-screen h-full  flex flex-wrap justify-center justify-items-center"),children:[Object(w.jsxs)("header",{className:"flex pl-5 items-center justify-between font-sans text-2xl font-bold text-red-400 bg-gray-800 h-24 w-full",children:["I'm a Blogger now",Object(w.jsx)(N,{setShow:h})]}),b?Object(w.jsx)(k,{setUser:T}):null,Object(w.jsxs)("div",{className:"dark:bg-gray-700 min-h-screen h-full self-center w-full flex flex-wrap justify-center font-sans",children:[Object(w.jsx)("div",{className:"w-full mt-5 mx-10 mb-0 flex justify-end",children:Object(w.jsxs)("label",{className:"switch",children:[Object(w.jsx)("input",{onClick:function(){return P((function(e){return!e}))},type:"checkbox",checked:E}),Object(w.jsx)("span",{className:"slider round"})]})}),l?Object(w.jsx)("div",{className:"loader"}):d?Object(w.jsx)("p",{children:'"Failed to load posts."'}):n.map((function(e){var t=new Date(e.updatedAt);return C(e.text)?Object(w.jsx)("div",{className:"flex flex-wrap w-4/5 justify-center",children:Object(w.jsx)(g,{postId:e._id,title:e.title,html:e.text,isPublished:e.isPublished,date:t.toDateString()},e._id)},e._id):Object(w.jsx)("div",{className:"flex flex-wrap w-4/5 justify-center",children:Object(w.jsx)(g,{postId:e._id,title:e.title,text:e.text,isPublished:e.isPublished,date:t.toDateString()})},e._id)}))]})]})})}a.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(T,{})}),document.getElementById("root"))},9:function(e,t,n){}},[[45,1,2]]]);
//# sourceMappingURL=main.04c9686b.chunk.js.map